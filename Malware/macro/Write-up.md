# Abdullah Ali Alhakami
# Twitter : @Alhakami1_
# Email : Aalhakami.26@gmail.com

Description : - 

Level : Hard

Enjoy :



First what is .docm mean ? file with the DOCM file extension is a Microsoft Word "Macro-Enabled" Document file. 

Now let's change the extension to zip and unzip the file (We know that : Microsof Office's files are actually zip archives with a bunch of XMLs and all the attached media.)
 
 ![image](https://user-images.githubusercontent.com/99384019/153738759-dc8484df-423e-44bd-96e4-f57242632b2f.png)

 
Let’s check the docProps directory (docProps) where metadata and information about the documents shows . 
Let’s see core.xml where metadata should be stored . 
Command : cat core.xml

![image](https://user-images.githubusercontent.com/99384019/153738770-5a2f7a91-f69c-40e6-878b-e9e3452dbc5b.png)
 
Wooow , This is the payload encoded in base64 and also we notes last modified by “mr.robot”
Let’s take the base64 and decode it :
 
![image](https://user-images.githubusercontent.com/99384019/153738780-92b4f24f-1f06-44bd-85c2-9283e5580e24.png)

So it’s executable file ha ? let’s decode the base64 to a file and analyze it . 
 
![image](https://user-images.githubusercontent.com/99384019/153738785-6fbda79a-5ca2-4d70-b511-83b92160558b.png)

Now let’s run a strings to that executable file to see if there anything suspicious ?

![image](https://user-images.githubusercontent.com/99384019/153738796-f2ab6eba-132b-4048-9c24-77f3781b03de.png)
 
Okay , so now I think you got it right ? this executable file run a powershell and execute this encoded command ! for now let’s decode the command :

![image](https://user-images.githubusercontent.com/99384019/153738805-a138adf6-aacf-4a77-9b73-256dad82f221.png)


After removing all the dot (.) : 

![image](https://user-images.githubusercontent.com/99384019/153738810-0be05a3f-14ff-4635-bf45-ef85f7cf869c.png)

 
So this is a php script and we can see it’s using xor and giving you the base64 (Assuming it’s the flag)
So we all knows in xor if we have ( a + b ) you can find c . we have the a = base64 and the b =Flag formula
So we can got the C = full flag right ?

![image](https://user-images.githubusercontent.com/99384019/153738813-4c5fe587-5b82-4a2d-a2ff-350e468de59d.png)

: ) 

![image](https://user-images.githubusercontent.com/99384019/153738817-3f855102-28fc-485a-b1d5-233d69775433.png)

Flag : cyberhub_{crypt0gr4phy_kn0wn_pl41nt3xt_4tt4ck}









 

